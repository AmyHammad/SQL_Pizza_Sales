@@ KPI’s

# Total Revenue:

SELECT SUM(total_price) AS Total_Revenue FROM pizza_sales


# Average Order Value

SELECT SUM(total_price) / COUNT(DISTINCT order_id) AS Avg_Order_Value FROM pizza_sales 

# Total Pizzas Sold:

SELECT SUM(quantity) AS Total_Pizza_Sold FROM pizza_sales

# Total Orders

SELECT COUNT(DISTINCT order_id) AS Total_Orders FROM pizza_sales

#Average Pizza Per Order:

SELECT CAST(CAST(SUM(quantity) AS DECIMAL(10,2)) / 
CAST(COUNT(DISTINCT order_id) AS DECIMAL(10,2)) AS DECIMAL(10,2))
AS Avg_Pizzas_per_order
FROM pizza_sales

//
- **`SUM(quantity)`** → Adds up the total number of pizzas sold across all orders.
    
- **`COUNT(DISTINCT order_id)`** → Counts how many **unique orders** were made.
    
- **`CAST(... AS DECIMAL(10,2))`** → Ensures both `SUM(quantity)` and `COUNT(...)` return **decimal values** (like `204.00`, `57.00`) before dividing.
    
- **Division:** We divide the **decimal total quantity** by the **decimal total orders**, so we get a **decimal result**.
    
- **Final `CAST(... AS DECIMAL(10,2))`** → Rounds the final result to **2 decimal places**, e.g., `3.58`.
//


@@ Daily Trend for Total Orders (order days, total orders per day)

SELECT DATENAME(DW, order_date) AS order_day, COUNT(DISTINCT order_id) AS Total_orders
FROM pizza_sales
GROUP BY DATENAME(DW, order_date)



@@ Monthly Trend for Orders

SELECT DATENAME(MONTH, order_date) AS Month_Name, COUNT(DISTINCT order_id) AS Total_orders
FROM pizza_sales
GROUP BY DATENAME(MONTH, order_date)
ORDER BY Total_Orders DESC

@@ % of Sales by Pizza Category: How much each pizza category makes in revenue 

Percentage of Sales per Category = (Category Sales / Total Sales) * 100 

- SUM(Total_Sales) FROM pizza_sales  (over all sales)


SELECT pizza_catergory, 
       CAST(SUM(total_price) AS DECIMAL(10, 2)) AS Total_Revenue,
       CAST(SUM(total_price) * 100 / (SELECT SUM(total_price) FROM pizza_sales) 
       AS DECIMAL(10, 2)) AS PCT
FROM pizza_sales
GROUP BY pizza_category



@@ % of Sales by Pizza Size:  (pizza_size, total_revenue, PCT)

SELECT pizza_size,
    CAST(SUM(total_price) AS DECIMAL(10,2)) AS Total_revenue,
    CAST(SUM(total_price) * 100 / (SELECT SUM(total_price) FROM pizza_sales)
    AS DECIMAL (10,2)) AS PCT
FROM pizza_sales
GROUP BY pizza_size
ORDER BY PCT DESC


@@ Total Pizza Sold by Pizza Category (total qty sold per category)

SELECT pizza_category,
    SUM(quantity) AS Total_Quantity_Sold 
FROM pizza_sales
WHERE MONTH(order_date) = 2
GROUP BY pizza_category
ORDER BY Total_Quantity_Sold DESC


@@  Top 5 Pizzas by Revenue (pizza_name, total_revenue for each name)


SELECT TOP 5 pizza_name, SUM(total_price) AS Total_Revenue 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Revenue DESC


@@ Bottom 5 Pizzas by Revenue

SELECT TOP 5 pizza_name, SUM(total_price) AS Total_Revenue 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Revenue ASC



@@ Top 5 Pizzas by Quantity (TOP PIZZA SOLD)

SELECT Top 5 pizza_name, SUM(quantity) AS Total_Pizza_Sold
FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Pizza_Sold DESC


@@ Top 5 Pizzas by Total Orders

SELECT Top 5 pizza_name, COUNT(DISTINCT order_id) AS Total_Orders
FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Orders DESC





